# 平台管理模块 (SystemAdmin) 详细设计规范 (SDD)

## 1. 消息、服务状态管理 (Messaging & Service Status)
### 1.1 业务概述
实现外事出国审批流程、任务进度等消息的异步推送与全链路服务心跳监测。
### 1.2 技术规范
- **异步推送**: 采用消息队列（如 Redis Stream/RabbitMQ）实现通知解耦，支持 Webhook、短信、政务钉钉多渠道。
- **状态同步**: 实时监控“出访前-执行中-回国后”三个阶段的服务状态，确保分布式环境下数据的一致性（Eventual Consistency）。
- **指标**: 消息触达延迟 < 500ms，服务心跳扫描周期 10s/次。

## 2. 用户鉴权与请求管理 (Auth & Request Management)
### 2.1 业务概述
建立用户全生命周期管理，集成 MFA 多因素鉴权，并对高频异常请求执行自动熔断。
### 2.2 技术规范
- **身份治理**: RBAC 权限模型 + MFA（TOTP/CA 证书）。
- **请求频控**: 针对核心 API（如成果发布）设置 Token Bucket 限流算法，阈值默认 500 req/min。
- **审计留痕**: 所有鉴权失败与提权操作强制记录至不可篡改的日志存储层。

## 3. 结构化数据内容管理与存储 (Structured Data Management)
### 3.1 业务概述
定时采集外事业务数据，形成周期快照，并通过合规字典执行数据清洗。
### 3.2 技术规范
- **快照策略**: 每日增量备份，每月全量快照，支持 Point-in-time Recovery (PITR)。
- **清洗引擎**: 基于正则表达式与业务规则字典，自动过滤无效证件号、格式错误金额等。
- **存储架构**: 分级存储策略（Hot: SSD, Warm: HDD, Cold: OSS）。

## 4. 非结构化数据内容管理与存储 (Unstructured Data Management)
### 4.1 业务概述
采集报告、照片、协议等非结构化数据，通过 OCR/NLP 提取特征并转化为结构化信息。
### 4.2 技术规范
- **处理流水线**: 文件上传 -> 病毒扫描 -> OCR 文字提取 -> NLP 实体识别（NER）。
- **标签化**: 自动为文档生成 [国别]、[行业]、[密级]、[成果类型] 标签。
- **脱敏**: 自动识别并掩码處理扫描件中的敏感个人信息（PII）。

## 5. 信息检索与推荐 (AI-Search & Recommendation)
### 5.1 业务概述
构建基于 RAG（检索增强生成）技术的专属检索推荐系统。
### 5.2 技术规范
- **向量检索**: 文本 Embedding 存储于向量資料庫（如 Pinecone/Milvus），支持语义相似度检索。
- **智能推荐**: 根據用戶的角色偏好与历史关注点，计算余弦相似度进行成果推荐。
- **多维筛选**: 整合業務維度（如出訪單位、轉化率、政策吻合度）的混合检索。

## 6. 学习与进化服务 (Learning & Evolution Service)
### 6.1 业务概述
基于业务数据运用机器学习算法，形成知识图谱，并优化管理监督流程。
### 6.2 技术规范
- **知识图谱**: 自动关联“人员-单位-项目-成果-风险”实体，展示关联热力图。
- **进化逻辑**: 分析审批被驳回的高頻原因，自动向管理端提交“流程优化建议”。
- **日志提炼**: 过滤 90% 以上的冗余系统日志，仅保留具有业务监督价值的关键行为日志。

## 7. 日志分析与查询 (Log Analysis & Query)
### 7.1 业务概述
提供多维日志查询工具与可视化 Dashboard，实时监测异常指标并触发告警。
### 7.2 技术规范
- **可视化**: 采用 Recharts 渲染实时流量图、异常分布饼图与合规雷达图。
- **告警机制**: 定义多级告警阈值（Level 1: UI 提醒, Level 2: 邮件/短信, Level 3: 自动关停异常 API）。
- **可追溯性**: 支持跨子系统的 Trace ID 关联查詢，实现请求全链路溯源。

## 8. 系统配置/微服务注册 (Config & Service Registry)
### 8.1 业务概述
提供在线参数热调整，适配政策变动；监控微服务注册中心状态。
### 8.2 技术规范
- **动态配置**: 关键业务红线（如出访天数、人均限额）支持在线修改并实时生效（无需重启）。
- **服务治理**: 集成微服务健康檢查，展示 Nacos/Consul 注册中心的节点存活状态。
- **热更新**: 配置变更自动推送到各业务节点，并記錄變更人與變更時間。
